montageDefine("291d12f","core/contextualizer",{dependencies:["montage/montage","q"],factory:function(e,o){var i=e("montage/montage").Montage,t=e("q");o.Contextualizer=i.specialize({constructor:{value:function(){this.super(),this.defaultLocale="en",this.currentLocale=this.defaultLocale;var e=this;return this._contextualizationHolder=this._contextualizationHolder||{data:{},gimme:function(o){var i=t.defer(),n=o;return window.setTimeout(function(){return e._contextualizationHolder.data[e.currentLocale]&&e._contextualizationHolder.data[e.currentLocale][o]&&void 0!==e._contextualizationHolder.data[e.currentLocale][o].message&&e._contextualizationHolder.data[e.currentLocale][o].message?(n=e._contextualizationHolder.data[e.currentLocale][o].message,console.log("Resolving localization quickly",n),i.resolve(n),void 0):(window.setTimeout(function(){e._contextualizationHolder.data[e.currentLocale]&&e._contextualizationHolder.data[e.currentLocale][o]&&void 0!==e._contextualizationHolder.data[e.currentLocale][o].message&&e._contextualizationHolder.data[e.currentLocale][o].message?n=e._contextualizationHolder.data[e.currentLocale][o].message:e._contextualizationHolder.data[e.currentLocale]&&e._contextualizationHolder.data[e.currentLocale][o]&&void 0!==e._contextualizationHolder.data[e.currentLocale][o].message&&e._contextualizationHolder.data[e.currentLocale][o].message,console.log("Resolving localization slowly",n),i.resolve(n)},1e3),void 0)},100),i.promise}},window.contextualizer=this,this}},_require:{value:"undefined"!=typeof global?global.require:"undefined"!=typeof window?window.require:null},_contextualizationHolder:{value:null},localize:{value:function(e){return this._contextualizationHolder.gimme(e)}},addFiles:{value:function(e){for(var o=[],i=this,n=0;e.length>n;n++){this._contextualizationHolder.data[e[n].localeCode]=this._contextualizationHolder.data[e[n].localeCode]||{},console.log("Loading "+e[n].path);var a=this._require.read(e[n].path);(function(e){a.then(function(o){return i.addMessagesToContextualizedStrings(o,e)})})(e[n].localeCode),o.push(a)}return t.all(o)}},addMessagesToContextualizedStrings:{value:function(e,o){var i=t.defer(),n=this;return window.setTimeout(function(){if(!e)return i.reject("No data"),void 0;e=JSON.parse(e);for(var t in e)e.hasOwnProperty(t)&&(n._contextualizationHolder.data[o][t]=e[t]);i.resolve("Okay")},100),i.promise}}})}});